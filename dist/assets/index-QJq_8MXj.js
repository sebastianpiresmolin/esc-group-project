(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const l of e)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerPolicy&&(l.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?l.credentials="include":e.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(e){if(e.ep)return;e.ep=!0;const l=i(e);fetch(e.href,l)}})();(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const l of e.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(n){if(n.ep)return;n.ep=!0;const e=o(n);fetch(n.href,e)}})();document.getElementById("headerButton").addEventListener("click",function(){let t=document.getElementById("menuOverlay"),o=document.getElementById("popinMenu");t.style.display="block",o.style.display="flex",setTimeout(function(){o.style.animation="grow 0.1s linear",o.style.opacity=1},100),setTimeout(function(){t.style.animation="fadein 0.3s linear",t.style.opacity=1},10),document.documentElement.style.overflowY="hidden"});document.getElementById("closebtn").addEventListener("click",function(){let t=document.getElementById("menuOverlay"),o=document.getElementById("popinMenu");t.style.animation="",o.style.animation="",t.style.opacity=0,o.style.opacity=0,setTimeout(function(){t.style.display="none",o.style.display="none"},200),document.documentElement.style.overflowY="auto"});document.getElementById("linkToChallenges").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges2").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges3").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges4").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges5").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges6").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});let u={online:!0,onsite:!0,minRating:1,maxRating:5,labels:[],words:[]};const le=document.body.dataset.page;if(le==="challenges"){let t=function(l,a,r){const s=document.querySelectorAll(".challenge"),p=document.querySelectorAll("#ratingID"),m=document.getElementById("noMatchError");let c=!1;l.forEach(d=>d.classList.remove("checked"));for(let d=0;d<=a;d++)l[d].classList.add("checked");const y=a+1;if(r)if(y<=u.maxRating)u.minRating=y;else for(let d=u.maxRating;d<=a;d++)l[d].classList.remove("checked");else u.maxRating=y,u.maxRating<u.minRating&&(u.minRating=u.maxRating,i[u.minRating-1].click());if(y>=u.minRating&&y<=u.maxRating)for(let d=0;d<s.length;d++){let _=p[d].textContent;_>=u.minRating&&_<=u.maxRating?(s[d].style.display="",c=!0):s[d].style.display="none",s[d].style.display=="none"&&c==!1?m.innerHTML="No matching challenges":m.innerHTML=""}},o=function(){const l=document.querySelector(".filterInputBox input").value.toLowerCase(),a=document.querySelectorAll(".challenge"),r=document.querySelectorAll(".challenge h2"),s=document.querySelectorAll("#descID"),p=document.getElementById("noMatchError");let m=!1;for(let c=0;c<a.length;c++){let y=r[c].textContent||r[c].innerHTML,d=s[c].innerHTML||s[c].innerText;y.toLowerCase().indexOf(l)>-1||d.toLowerCase().indexOf(l)>-1?(a[c].style.display="",m=!0):a[c].style.display="none"}m?p.innerHTML="":p.innerHTML="No matching challenges"};const i=[document.querySelector("#fromOne"),document.querySelector("#fromTwo"),document.querySelector("#fromThree"),document.querySelector("#fromFour"),document.querySelector("#fromFive")],n=[document.querySelector("#toOne"),document.querySelector("#toTwo"),document.querySelector("#toThree"),document.querySelector("#toFour"),document.querySelector("#toFive")];i.forEach((l,a)=>{l.addEventListener("click",()=>t(i,a,!0))}),n.forEach((l,a)=>{l.addEventListener("click",()=>t(n,a,!1))});const e=document.querySelector(".filterInputBox input");e.addEventListener("keyup",function(l){if(l.key==="Enter"){const a=e.value.toLowerCase();e.value="",u.words=a.split(" ")}}),document.getElementById("searchBox").addEventListener("keyup",o)}let v,F=[];class ae{constructor(o){this.data=o}render(){const o=document.createElement("div");o.classList.add("challenge");const i=document.createElement("div");i.classList.add("img__container"),o.append(i);const n=document.createElement("img");n.src=this.data.image,n.classList.add("img__container"),i.append(n);const e=document.createElement("h2");e.textContent=this.data.title+" ("+this.data.type+")",o.append(e);function l(L){const b=document.createElement("div");b.classList.add("star__container");const R='<img class="rating__star" src="media/full_star.png" alt="Full star">',j='<img class="rating__star" src="media/half_star.png" alt="Half star">',ne='<img class="rating__star" src="media/no_star.png" alt="No star">',N=Math.floor(L),V=L%1!==0;for(let S=0;S<N;S++)b.innerHTML+=R;V&&(b.innerHTML+=j);const oe=V?5-N-1:5-N;for(let S=0;S<oe;S++)b.innerHTML+=ne;return b}const a=document.createElement("div");a.classList.add("rating__container"),a.appendChild(l(this.data.rating)),o.appendChild(a);const r=document.createElement("p");r.textContent=this.data.rating,o.append(r),r.setAttribute("id","ratingID"),r.style.display="none";const s=document.createElement("span");s.textContent=this.data.minParticipants+" - "+this.data.maxParticipants+" participants",a.appendChild(s);const p=document.createElement("p");p.textContent="Description: "+this.data.description,o.append(p),p.setAttribute("id","descID");let m,c=[];for(let L=0;L<this.data.labels.length;L++)m=document.createElement("p"),c=this.data.labels,m.textContent="Labels: "+c[L],m.classList.add("labels"),m.classList.add("cardLabels"),m.setAttribute("id","cardLabels"),m.style.display="none",o.append(m);let y,d=[];y=document.createElement("p"),d=this.data.type,y.textContent="Type: "+d,y.classList.add("cardType"),y.setAttribute("id","cardType"),y.style.display="none",o.append(y);const _=document.createElement("button");return _.textContent="Book this room",_.dataset.challengeId=this.data.id,o.append(_),_.addEventListener("click",function(L){const b=L.currentTarget.dataset.challengeId;me(),v=F.find(j=>j.data.id===parseInt(b));const R=document.querySelector("#modal1__title");R.textContent='Book Room: "'+v.data.title+'" (Step 1)'}),o}}class ee{async getAllChallenges(){return F=(await(await fetch("https://lernia-sjj-assignments.vercel.app/api/challenges")).json()).challenges.map(o=>new ae(o)),F}}class se{async render(o){const i=await new ee().getAllChallenges();for(let n=0;n<i.length;n++){const e=i[n].render();o.append(e)}}}class ce{async render(o){const i=(await new ee().getAllChallenges()).sort((n,e)=>e.data.rating-n.data.rating);for(let n=0;n<3;n++){const e=i[n].render();o.append(e)}}}const Y=document.body.dataset.page;document.querySelector("#modal__bg");if(Y==="challenges"){const t=document.querySelector(".challenges__container");new se().render(t)}else if(Y==="front-page"){const t=document.querySelector(".containerTwo__carousel");new ce().render(t)}if(Y==="challenges"){let t=function(){const e=document.querySelectorAll(".challenge"),l=document.querySelectorAll(".cardType"),a=document.getElementById("noMatchError");let r=!1;if(i.checked&&!n.checked)for(let s=0;s<e.length;s++)l[s].textContent.toLowerCase().includes("online")?(e[s].style.display="",r=!0):e[s].style.display="none",r?a.innerHTML="":a.innerHTML="No matching challenges";else if(n.checked&&!i.checked)for(let s=0;s<e.length;s++)l[s].textContent.toLowerCase().includes("onsite")?(e[s].style.display="",r=!0):e[s].style.display="none",r?a.innerHTML="":a.innerHTML="No matching challenges";else if(i.checked&&n.checked)for(let s=0;s<e.length;s++)e[s]?(e[s].style.display="",r=!0):e[s].style.display="none",r?a.innerHTML="":a.innerHTML="No matching challenges";else if(!i.checked&&!n.checked)for(let s=0;s<e.length;s++)e[s].style.display="none",a.innerHTML="No matching challenges"},o=function(e){const l=e.id;e.classList.contains("active")?(e.classList.remove("active"),u.labels=u.labels.filter(c=>c!==l),console.log("Removed tag:",l),console.log("Current labels:",u.labels)):(e.classList.add("active"),u.labels.push(l),console.log("Current labels:",u.labels));const a=document.querySelectorAll(".challenge"),r=document.querySelectorAll(".cardLabels");document.querySelectorAll(".filterTags label");const s=u.labels,p=document.getElementById("noMatchError");let m=!1;for(let c=0;c<a.length;c++)r[c].innerHTML.toLowerCase().indexOf(s)>-1?(a[c].style.display="",m=!0):a[c].style.display="none",m?p.innerHTML="":p.innerHTML="No matching challenges"};const i=document.querySelector("#online"),n=document.querySelector("#onsite");i.addEventListener("click",t),n.addEventListener("click",t),[document.querySelector("#web"),document.querySelector("#linux"),document.querySelector("#cryptography"),document.querySelector("#coding"),document.querySelector("#ssh"),document.querySelector("#ctf"),document.querySelector("#hacking"),document.querySelector("#bash"),document.querySelector("#javascript"),document.querySelector("#electronics"),document.querySelector("#phreaking")].forEach(e=>{e.addEventListener("click",()=>o(e))})}let z=[],C=new URL("https://lernia-sjj-assignments.vercel.app/api/booking/available-times?date=2023-12-12&challenge=4'"),X=[],P,D;const h=document.getElementById("modal__bg");h.classList.add("modal__background");h.style.overflowY="hidden";const k=document.createElement("div");k.classList.add("modal__container1");const w=document.createElement("div");w.classList.add("modal__container2");const x=document.createElement("div");x.classList.add("modal__container3");const E=document.createElement("h1");E.classList.add("modal__title");E.setAttribute("id","modal1title");const Z=document.createElement("h2");Z.classList.add("modal__subtitle");h.addEventListener("click",function(t){t.target===h&&ie()});function ie(){h.style.display="none",k.style.display="none",w.style.display="none",x.style.display="none",g.value="",T.value="",q.value="",I.innerHTML="",A.innerHTML="",f.textContent=""}const U=document.createElement("p");U.classList.add("modal__date");const g=document.createElement("input");g.setAttribute("type","date");g.classList.add("input__date");const Q=document.createElement("div"),f=document.createElement("p");f.classList.add("error__msg");Q.appendChild(f);const H=document.createElement("button");H.classList.add("button__search");H.textContent="Search available times";const $=document.createElement("p");$.classList.add("modal__name");const T=document.createElement("input");T.setAttribute("type","text");T.classList.add("input__name");const K=document.createElement("p");K.classList.add("modal__name");const q=document.createElement("input");q.setAttribute("type","text");q.classList.add("input__mail");const W=document.createElement("p");W.classList.add("modal__time");const re=document.createElement("ul");re.classList.add("time__list");const I=document.createElement("select");I.classList.add("select__menu__time");const J=document.createElement("p");J.classList.add("modal__participants");const A=document.createElement("select");A.classList.add("select__menu__part");const O=document.createElement("button");O.classList.add("button__submit");O.textContent="Submit booking";const G=document.createElement("h1");G.classList.add("title__thankyou");const M=document.createElement("a");M.classList.add("modal__linkback");const B=new Date,te=B.toISOString().substring(0,10),de=new Date(B.getFullYear(),B.getMonth()+12,B.getDate()),ue=de.toISOString().substring(0,10);function me(){return h.style.display="block",k.style.display="block",E.setAttribute("id","modal1__title"),Z.textContent="What date would you like to come?",U.textContent="Date",g.value=te,k.append(E,Z,U,g,Q,H),h.append(k),E}function pe(){E.textContent='Book Room: "'+v.data.title+'" (Step 2)',h.style.display="block",k.style.display="none",w.style.display="block",E.setAttribute("id","modal2__title"),$.textContent="Name",K.textContent="E-mail",W.textContent="What time?",J.textContent="How many participants?",w.append(E,Q,$,T,K,q,W,I,J,A,O),h.append(w)}async function ye(){h.style.display="block",w.style.display="none",x.style.display="flex",G.textContent="Thank you!",M.text="Close window",M.setAttribute("href",""),x.append(G,M),h.append(x)}async function he(){H.addEventListener("click",function(){let t=new URLSearchParams(C.search),o=v.data.id;return g.value<te||g.value>ue?(f.textContent="You must choose a date newer than today and within a year!",f.style.color="red"):(t.set("date",g.value),t.set("id",parseInt(o)),C.search=t.toString(),C=C.toString(),ge(),pe(),f.textContent=""),C})}async function ge(){(await(await fetch(C)).json()).slots.forEach(t=>{z.push(t),P=document.createElement("option"),P.innerText=t,I.appendChild(P)});for(let t=v.data.minParticipants;t<=v.data.maxParticipants;t++)X.push(t);return X.forEach(t=>{D=document.createElement("option"),D.innerText=t+" participants",A.appendChild(D)}),z}he();function fe(){O.addEventListener("click",function(){let t=v.data.id,o=T.value.trim(),i=o.charAt(0).toUpperCase()+o.slice(1).toLowerCase(),n=/^[a-zA-Z]+ [a-zA-Z]+$/,e=q.value.trim(),l=g.value;const a=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;if(i.match(n))if(e.match(a)){let r=I.selectedOptions,s="";for(let c=0;c<r.length;c++)s+=r[c].label;console.log(z);let p="",m=A.selectedOptions;for(let c=0;c<m.length;c++)p+=m[c].label;return Le(t,i,e,l,s,parseInt(p)),f.textContent="",ye(),!0}else return f.textContent="You must enter a valid email!",!1;else return f.textContent="You must enter your first name and last name",!1})}fe();async function Le(t,o,i,n,e,l){const a=await(await fetch("https://lernia-sjj-assignments.vercel.app/api/booking/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challenge:t,name:o,email:i,date:n,time:e,participants:l})})).json();console.log(a)}
