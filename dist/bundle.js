(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function c(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(e){if(e.ep)return;e.ep=!0;const o=c(e);fetch(e.href,o)}})();(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&c(o)}).observe(document,{childList:!0,subtree:!0});function l(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(t){if(t.ep)return;t.ep=!0;const e=l(t);fetch(t.href,e)}})();(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&c(o)}).observe(document,{childList:!0,subtree:!0});function l(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(t){if(t.ep)return;t.ep=!0;const e=l(t);fetch(t.href,e)}})();(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&c(o)}).observe(document,{childList:!0,subtree:!0});function l(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(t){if(t.ep)return;t.ep=!0;const e=l(t);fetch(t.href,e)}})();document.getElementById("headerButton").addEventListener("click",function(){let n=document.getElementById("menuOverlay"),l=document.getElementById("popinMenu");n.style.display="block",l.style.display="flex",setTimeout(function(){l.style.animation="grow 0.1s linear",l.style.opacity=1},100),setTimeout(function(){n.style.animation="fadein 0.3s linear",n.style.opacity=1},10),document.documentElement.style.overflowY="hidden"});document.getElementById("closebtn").addEventListener("click",function(){let n=document.getElementById("menuOverlay"),l=document.getElementById("popinMenu");n.style.animation="",l.style.animation="",n.style.opacity=0,l.style.opacity=0,setTimeout(function(){n.style.display="none",l.style.display="none"},200),document.documentElement.style.overflowY="auto"});document.getElementById("linkToChallenges").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges2").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges3").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges4").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges5").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});document.getElementById("linkToChallenges6").addEventListener("click",function(){window.location.href="https://sebastianpiresmolin.github.io/esc-group-project/challenges.html"});let u={online:!0,onsite:!0,minRating:1,maxRating:5,labels:[],words:[]};const le=document.body.dataset.page;if(le==="challenges"){let n=function(o,a,r){const s=document.querySelectorAll(".challenge"),p=document.querySelectorAll("#ratingID"),m=document.getElementById("noMatchError");let i=!1;o.forEach(d=>d.classList.remove("checked"));for(let d=0;d<=a;d++)o[d].classList.add("checked");const y=a+1;if(r)if(y<=u.maxRating)u.minRating=y;else for(let d=u.maxRating;d<=a;d++)o[d].classList.remove("checked");else u.maxRating=y,u.maxRating<u.minRating&&(u.minRating=u.maxRating,c[u.minRating-1].click());if(y>=u.minRating&&y<=u.maxRating)for(let d=0;d<s.length;d++){let b=p[d].textContent;b>=u.minRating&&b<=u.maxRating?(s[d].style.display="",i=!0):s[d].style.display="none",s[d].style.display=="none"&&i==!1?m.innerHTML="No matching challenges":m.innerHTML=""}},l=function(){const o=document.querySelector(".filterInputBox input").value.toLowerCase(),a=document.querySelectorAll(".challenge"),r=document.querySelectorAll(".challenge h2"),s=document.querySelectorAll("#descID"),p=document.getElementById("noMatchError");let m=!1;for(let i=0;i<a.length;i++){let y=r[i].textContent||r[i].innerHTML,d=s[i].innerHTML||s[i].innerText;y.toLowerCase().indexOf(o)>-1||d.toLowerCase().indexOf(o)>-1?(a[i].style.display="",m=!0):a[i].style.display="none"}m?p.innerHTML="":p.innerHTML="No matching challenges"};const c=[document.querySelector("#fromOne"),document.querySelector("#fromTwo"),document.querySelector("#fromThree"),document.querySelector("#fromFour"),document.querySelector("#fromFive")],t=[document.querySelector("#toOne"),document.querySelector("#toTwo"),document.querySelector("#toThree"),document.querySelector("#toFour"),document.querySelector("#toFive")];c.forEach((o,a)=>{o.addEventListener("click",()=>n(c,a,!0))}),t.forEach((o,a)=>{o.addEventListener("click",()=>n(t,a,!1))});const e=document.querySelector(".filterInputBox input");e.addEventListener("keyup",function(o){if(o.key==="Enter"){const a=e.value.toLowerCase();e.value="",u.words=a.split(" ")}}),document.getElementById("searchBox").addEventListener("keyup",l)}let v,F=[];class ae{constructor(l){this.data=l}render(){const l=document.createElement("div");l.classList.add("challenge");const c=document.createElement("div");c.classList.add("img__container"),l.append(c);const t=document.createElement("img");t.src=this.data.image,t.classList.add("img__container"),c.append(t);const e=document.createElement("h2");e.textContent=this.data.title+" ("+this.data.type+")",l.append(e);function o(L){const _=document.createElement("div");_.classList.add("star__container");const N='<img class="rating__star" src="media/full_star.png" alt="Full star">',R='<img class="rating__star" src="media/half_star.png" alt="Half star">',ne='<img class="rating__star" src="media/no_star.png" alt="No star">',P=Math.floor(L),V=L%1!==0;for(let C=0;C<P;C++)_.innerHTML+=N;V&&(_.innerHTML+=R);const oe=V?5-P-1:5-P;for(let C=0;C<oe;C++)_.innerHTML+=ne;return _}const a=document.createElement("div");a.classList.add("rating__container"),a.appendChild(o(this.data.rating)),l.appendChild(a);const r=document.createElement("p");r.textContent=this.data.rating,l.append(r),r.setAttribute("id","ratingID"),r.style.display="none";const s=document.createElement("span");s.textContent=this.data.minParticipants+" - "+this.data.maxParticipants+" participants",a.appendChild(s);const p=document.createElement("p");p.textContent="Description: "+this.data.description,l.append(p),p.setAttribute("id","descID");let m,i=[];for(let L=0;L<this.data.labels.length;L++)m=document.createElement("p"),i=this.data.labels,m.textContent="Labels: "+i[L],m.classList.add("labels"),m.classList.add("cardLabels"),m.setAttribute("id","cardLabels"),m.style.display="none",l.append(m);let y,d=[];y=document.createElement("p"),d=this.data.type,y.textContent="Type: "+d,y.classList.add("cardType"),y.setAttribute("id","cardType"),y.style.display="none",l.append(y);const b=document.createElement("button");return b.textContent="Book this room",b.dataset.challengeId=this.data.id,l.append(b),b.addEventListener("click",function(L){const _=L.currentTarget.dataset.challengeId;me(),v=F.find(R=>R.data.id===parseInt(_));const N=document.querySelector("#modal1__title");N.textContent='Book Room: "'+v.data.title+'" (Step 1)'}),l}}class ee{async getAllChallenges(){return F=(await(await fetch("https://lernia-sjj-assignments.vercel.app/api/challenges")).json()).challenges.map(l=>new ae(l)),F}}class se{async render(l){const c=await new ee().getAllChallenges();for(let t=0;t<c.length;t++){const e=c[t].render();l.append(e)}}}class ce{async render(l){const c=(await new ee().getAllChallenges()).sort((t,e)=>e.data.rating-t.data.rating);for(let t=0;t<3;t++){const e=c[t].render();l.append(e)}}}const Y=document.body.dataset.page;document.querySelector("#modal__bg");if(Y==="challenges"){const n=document.querySelector(".challenges__container");new se().render(n)}else if(Y==="front-page"){const n=document.querySelector(".containerTwo__carousel");new ce().render(n)}if(Y==="challenges"){let n=function(){const e=document.querySelectorAll(".challenge"),o=document.querySelectorAll(".cardType"),a=document.getElementById("noMatchError");let r=!1;if(c.checked&&!t.checked)for(let s=0;s<e.length;s++)o[s].textContent.toLowerCase().includes("online")?(e[s].style.display="",r=!0):e[s].style.display="none",r?a.innerHTML="":a.innerHTML="No matching challenges";else if(t.checked&&!c.checked)for(let s=0;s<e.length;s++)o[s].textContent.toLowerCase().includes("onsite")?(e[s].style.display="",r=!0):e[s].style.display="none",r?a.innerHTML="":a.innerHTML="No matching challenges";else if(c.checked&&t.checked)for(let s=0;s<e.length;s++)e[s]?(e[s].style.display="",r=!0):e[s].style.display="none",r?a.innerHTML="":a.innerHTML="No matching challenges";else if(!c.checked&&!t.checked)for(let s=0;s<e.length;s++)e[s].style.display="none",a.innerHTML="No matching challenges"},l=function(e){const o=e.id;e.classList.contains("active")?(e.classList.remove("active"),u.labels=u.labels.filter(i=>i!==o),console.log("Removed tag:",o),console.log("Current labels:",u.labels)):(e.classList.add("active"),u.labels.push(o),console.log("Current labels:",u.labels));const a=document.querySelectorAll(".challenge"),r=document.querySelectorAll(".cardLabels");document.querySelectorAll(".filterTags label");const s=u.labels,p=document.getElementById("noMatchError");let m=!1;for(let i=0;i<a.length;i++)r[i].innerHTML.toLowerCase().indexOf(s)>-1?(a[i].style.display="",m=!0):a[i].style.display="none",m?p.innerHTML="":p.innerHTML="No matching challenges"};const c=document.querySelector("#online"),t=document.querySelector("#onsite");c.addEventListener("click",n),t.addEventListener("click",n),[document.querySelector("#web"),document.querySelector("#linux"),document.querySelector("#cryptography"),document.querySelector("#coding"),document.querySelector("#ssh"),document.querySelector("#ctf"),document.querySelector("#hacking"),document.querySelector("#bash"),document.querySelector("#javascript"),document.querySelector("#electronics"),document.querySelector("#phreaking")].forEach(e=>{e.addEventListener("click",()=>l(e))})}let z=[],k=new URL("https://lernia-sjj-assignments.vercel.app/api/booking/available-times?date=2023-12-12&challenge=4'"),X=[],j,D;const g=document.getElementById("modal__bg");g.classList.add("modal__background");g.style.overflowY="hidden";const w=document.createElement("div");w.classList.add("modal__container1");const S=document.createElement("div");S.classList.add("modal__container2");const x=document.createElement("div");x.classList.add("modal__container3");const E=document.createElement("h1");E.classList.add("modal__title");E.setAttribute("id","modal1title");const Z=document.createElement("h2");Z.classList.add("modal__subtitle");g.addEventListener("click",function(n){n.target===g&&ie()});function ie(){g.style.display="none",w.style.display="none",S.style.display="none",x.style.display="none",h.value="",T.value="",q.value="",I.innerHTML="",A.innerHTML="",f.textContent=""}const K=document.createElement("p");K.classList.add("modal__date");const h=document.createElement("input");h.setAttribute("type","date");h.classList.add("input__date");const Q=document.createElement("div"),f=document.createElement("p");f.classList.add("error__msg");Q.appendChild(f);const B=document.createElement("button");B.classList.add("button__search");B.textContent="Search available times";const U=document.createElement("p");U.classList.add("modal__name");const T=document.createElement("input");T.setAttribute("type","text");T.classList.add("input__name");const $=document.createElement("p");$.classList.add("modal__name");const q=document.createElement("input");q.setAttribute("type","text");q.classList.add("input__mail");const W=document.createElement("p");W.classList.add("modal__time");const re=document.createElement("ul");re.classList.add("time__list");const I=document.createElement("select");I.classList.add("select__menu__time");const J=document.createElement("p");J.classList.add("modal__participants");const A=document.createElement("select");A.classList.add("select__menu__part");const H=document.createElement("button");H.classList.add("button__submit");H.textContent="Submit booking";const G=document.createElement("h1");G.classList.add("title__thankyou");const M=document.createElement("a");M.classList.add("modal__linkback");const O=new Date,te=O.toISOString().substring(0,10),de=new Date(O.getFullYear(),O.getMonth()+12,O.getDate()),ue=de.toISOString().substring(0,10);function me(){return g.style.display="block",w.style.display="block",E.setAttribute("id","modal1__title"),Z.textContent="What date would you like to come?",K.textContent="Date",h.value=te,w.append(E,Z,K,h,Q,B),g.append(w),E}function pe(){E.textContent='Book Room: "'+v.data.title+'" (Step 2)',g.style.display="block",w.style.display="none",S.style.display="block",E.setAttribute("id","modal2__title"),U.textContent="Name",$.textContent="E-mail",W.textContent="What time?",J.textContent="How many participants?",S.append(E,Q,U,T,$,q,W,I,J,A,H),g.append(S)}async function ye(){g.style.display="block",S.style.display="none",x.style.display="flex",G.textContent="Thank you!",M.text="Close window",M.setAttribute("href",""),x.append(G,M),g.append(x)}async function ge(){B.addEventListener("click",function(){let n=new URLSearchParams(k.search),l=v.data.id;return h.value<te||h.value>ue?(f.textContent="You must choose a date newer than today and within a year!",f.style.color="red"):(n.set("date",h.value),n.set("id",parseInt(l)),k.search=n.toString(),k=k.toString(),he(),pe(),f.textContent=""),k})}async function he(){(await(await fetch(k)).json()).slots.forEach(n=>{z.push(n),j=document.createElement("option"),j.innerText=n,I.appendChild(j)});for(let n=v.data.minParticipants;n<=v.data.maxParticipants;n++)X.push(n);return X.forEach(n=>{D=document.createElement("option"),D.innerText=n+" participants",A.appendChild(D)}),z}ge();function fe(){H.addEventListener("click",function(){let n=v.data.id,l=T.value.trim(),c=l.charAt(0).toUpperCase()+l.slice(1).toLowerCase(),t=/^[a-zA-Z]+ [a-zA-Z]+$/,e=q.value.trim(),o=h.value;const a=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;if(c.match(t))if(e.match(a)){let r=I.selectedOptions,s="";for(let i=0;i<r.length;i++)s+=r[i].label;console.log(z);let p="",m=A.selectedOptions;for(let i=0;i<m.length;i++)p+=m[i].label;return Le(n,c,e,o,s,parseInt(p)),f.textContent="",ye(),!0}else return f.textContent="You must enter a valid email!",!1;else return f.textContent="You must enter your first name and last name",!1})}fe();async function Le(n,l,c,t,e,o){const a=await(await fetch("https://lernia-sjj-assignments.vercel.app/api/booking/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challenge:n,name:l,email:c,date:t,time:e,participants:o})})).json();console.log(a)}
