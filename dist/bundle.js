(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function a(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(e){if(e.ep)return;e.ep=!0;const o=a(e);fetch(e.href,o)}})();(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function l(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(t){if(t.ep)return;t.ep=!0;const e=l(t);fetch(t.href,e)}})();(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function l(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(t){if(t.ep)return;t.ep=!0;const e=l(t);fetch(t.href,e)}})();(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function l(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(t){if(t.ep)return;t.ep=!0;const e=l(t);fetch(t.href,e)}})();(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function l(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(t){if(t.ep)return;t.ep=!0;const e=l(t);fetch(t.href,e)}})();document.getElementById("headerButton").addEventListener("click",function(){let n=document.getElementById("menuOverlay"),l=document.getElementById("popinMenu");n.style.display="block",l.style.display="flex",setTimeout(function(){l.style.animation="grow 0.1s linear",l.style.opacity=1},100),setTimeout(function(){n.style.animation="fadein 0.3s linear",n.style.opacity=1},10),document.documentElement.style.overflowY="hidden"});document.getElementById("closebtn").addEventListener("click",function(){let n=document.getElementById("menuOverlay"),l=document.getElementById("popinMenu");n.style.animation="",l.style.animation="",n.style.opacity=0,l.style.opacity=0,setTimeout(function(){n.style.display="none",l.style.display="none"},200),document.documentElement.style.overflowY="auto"});let u={online:!0,onsite:!0,minRating:1,maxRating:5,labels:[],words:[]};const ce=document.body.dataset.page;if(ce==="challenges"){let n=function(o,r,d){const s=document.querySelectorAll(".challenge"),p=document.querySelectorAll("#ratingID"),m=document.getElementById("noMatchError");let i=!1;o.forEach(c=>c.classList.remove("checked"));for(let c=0;c<=r;c++)o[c].classList.add("checked");const y=r+1;if(d)if(y<=u.maxRating)u.minRating=y;else for(let c=u.maxRating;c<=r;c++)o[c].classList.remove("checked");else u.maxRating=y,u.maxRating<u.minRating&&(u.minRating=u.maxRating,a[u.minRating-1].click());if(y>=u.minRating&&y<=u.maxRating)for(let c=0;c<s.length;c++){let C=p[c].textContent;C>=u.minRating&&C<=u.maxRating?(s[c].style.display="",i=!0):s[c].style.display="none",s[c].style.display=="none"&&i==!1?m.innerHTML="No matching challenges":m.innerHTML=""}},l=function(){const o=document.querySelector(".filterInputBox input").value.toLowerCase(),r=document.querySelectorAll(".challenge"),d=document.querySelectorAll(".challenge h2"),s=document.querySelectorAll("#descID"),p=document.getElementById("noMatchError");let m=!1;for(let i=0;i<r.length;i++){let y=d[i].textContent||d[i].innerHTML,c=s[i].innerHTML||s[i].innerText;y.toLowerCase().indexOf(o)>-1||c.toLowerCase().indexOf(o)>-1?(r[i].style.display="",m=!0):r[i].style.display="none"}m?p.innerHTML="":p.innerHTML="No matching challenges"};const a=[document.querySelector("#fromOne"),document.querySelector("#fromTwo"),document.querySelector("#fromThree"),document.querySelector("#fromFour"),document.querySelector("#fromFive")],t=[document.querySelector("#toOne"),document.querySelector("#toTwo"),document.querySelector("#toThree"),document.querySelector("#toFour"),document.querySelector("#toFive")];a.forEach((o,r)=>{o.addEventListener("click",()=>n(a,r,!0))}),t.forEach((o,r)=>{o.addEventListener("click",()=>n(t,r,!1))});const e=document.querySelector(".filterInputBox input");e.addEventListener("keyup",function(o){if(o.key==="Enter"){const r=e.value.toLowerCase();e.value="",u.words=r.split(" ")}}),document.getElementById("searchBox").addEventListener("keyup",l)}let b,F=[],oe=document.querySelectorAll(".spinner");class ie{constructor(l){this.data=l}render(){const l=document.createElement("div");l.classList.add("challenge");const a=document.createElement("div");a.classList.add("img__container"),l.append(a);const t=document.createElement("img");t.src=this.data.image,t.classList.add("img__container"),a.append(t),document.createElement("div").classList.add("titleIcon__div");const e=document.createElement("span");e.classList.add("card_icon"),l.append(e),this.data.type=="online"?(console.log("online"),e.innerHTML='<i class="fa fa-home"></i>'):(console.log("onsite"),e.innerHTML='<i class="fa fa-laptop" aria-hidden="true"></i>');const o=document.createElement("h2");o.textContent=this.data.title,l.append(o);function r(L){const _=document.createElement("div");_.classList.add("star__container");const R='<img class="rating__star" src="media/full_star.png" alt="Full star">',B='<img class="rating__star" src="media/half_star.png" alt="Half star">',se='<img class="rating__star" src="media/no_star.png" alt="No star">',j=Math.floor(L),ee=L%1!==0;for(let k=0;k<j;k++)_.innerHTML+=R;ee&&(_.innerHTML+=B);const re=ee?5-j-1:5-j;for(let k=0;k<re;k++)_.innerHTML+=se;return _}const d=document.createElement("div");d.classList.add("rating__container"),d.appendChild(r(this.data.rating)),l.appendChild(d);const s=document.createElement("p");s.textContent=this.data.rating,l.append(s),s.setAttribute("id","ratingID"),s.style.display="none";const p=document.createElement("span");p.textContent=this.data.minParticipants+" - "+this.data.maxParticipants+" participants",d.appendChild(p);const m=document.createElement("p");m.textContent="Description: "+this.data.description,l.append(m),m.setAttribute("id","descID");let i,y=[];for(let L=0;L<this.data.labels.length;L++)i=document.createElement("p"),y=this.data.labels,i.textContent="Labels: "+y[L],i.classList.add("labels"),i.classList.add("cardLabels"),i.setAttribute("id","cardLabels"),i.style.display="none",l.append(i);let c,C=[];c=document.createElement("p"),C=this.data.type,c.textContent="Type: "+C,c.classList.add("cardType"),c.setAttribute("id","cardType"),c.style.display="none",l.append(c);const I=document.createElement("button");return I.textContent="Book this room",I.dataset.challengeId=this.data.id,l.append(I),I.addEventListener("click",function(L){const _=L.currentTarget.dataset.challengeId;Le(),b=F.find(B=>B.data.id===parseInt(_));const R=document.querySelector("#modal1__title");R.textContent='Book Room: "'+b.data.title+'" (Step 1)'}),l}}function de(){oe.forEach(n=>{n.style.display="block"})}function ue(){oe.forEach(n=>{n.style.display="none"})}class le{async getAllChallenges(){de();const l=await fetch("https://lernia-sjj-assignments.vercel.app/api/challenges");return ue(),F=(await l.json()).challenges.map(a=>new ie(a)),F}}class me{async render(l){const a=await new le().getAllChallenges();for(let t=0;t<a.length;t++){const e=a[t].render();l.append(e)}}}class pe{async render(l){const a=(await new le().getAllChallenges()).sort((t,e)=>e.data.rating-t.data.rating);for(let t=0;t<3;t++){const e=a[t].render();l.append(e)}}}const z=document.body.dataset.page;document.querySelector("#modal__bg");if(z==="challenges"){const n=document.querySelector(".challenges__container");new me().render(n)}else if(z==="front-page"){const n=document.querySelector(".containerTwo__carousel");new pe().render(n)}if(z==="challenges"){let n=function(){const e=document.querySelectorAll(".challenge"),o=document.querySelectorAll(".cardType"),r=document.getElementById("noMatchError");let d=!1;if(a.checked&&!t.checked)for(let s=0;s<e.length;s++)o[s].textContent.toLowerCase().includes("online")?(e[s].style.display="",d=!0):e[s].style.display="none",d?r.innerHTML="":r.innerHTML="No matching challenges";else if(t.checked&&!a.checked)for(let s=0;s<e.length;s++)o[s].textContent.toLowerCase().includes("onsite")?(e[s].style.display="",d=!0):e[s].style.display="none",d?r.innerHTML="":r.innerHTML="No matching challenges";else if(a.checked&&t.checked)for(let s=0;s<e.length;s++)e[s]?(e[s].style.display="",d=!0):e[s].style.display="none",d?r.innerHTML="":r.innerHTML="No matching challenges";else if(!a.checked&&!t.checked)for(let s=0;s<e.length;s++)e[s].style.display="none",r.innerHTML="No matching challenges"},l=function(e){const o=e.id;e.classList.contains("active")?(e.classList.remove("active"),u.labels=u.labels.filter(i=>i!==o),console.log("Removed tag:",o),console.log("Current labels:",u.labels)):(e.classList.add("active"),u.labels.push(o),console.log("Current labels:",u.labels));const r=document.querySelectorAll(".challenge"),d=document.querySelectorAll(".cardLabels");document.querySelectorAll(".filterTags label");const s=u.labels,p=document.getElementById("noMatchError");let m=!1;for(let i=0;i<r.length;i++)d[i].innerHTML.toLowerCase().indexOf(s)>-1?(r[i].style.display="",m=!0):r[i].style.display="none",m?p.innerHTML="":p.innerHTML="No matching challenges"};const a=document.querySelector("#online"),t=document.querySelector("#onsite");a.addEventListener("click",n),t.addEventListener("click",n),[document.querySelector("#web"),document.querySelector("#linux"),document.querySelector("#cryptography"),document.querySelector("#coding"),document.querySelector("#ssh"),document.querySelector("#ctf"),document.querySelector("#hacking"),document.querySelector("#bash"),document.querySelector("#javascript"),document.querySelector("#electronics"),document.querySelector("#phreaking")].forEach(e=>{e.addEventListener("click",()=>l(e))})}let K=[],v=new URL("https://lernia-sjj-assignments.vercel.app/api/booking/available-times?date=2023-12-12&challenge=4'"),te=[],D,Y;const f=document.getElementById("modal__bg");f.classList.add("modal__background");f.style.overflowY="hidden";const S=document.createElement("div");S.classList.add("modal__container1");const x=document.createElement("div");x.classList.add("modal__container2");const w=document.createElement("div");w.classList.add("modal__container3");const E=document.createElement("h1");E.classList.add("modal__title");E.setAttribute("id","modal1title");const Z=document.createElement("h2");Z.classList.add("modal__subtitle");f.addEventListener("click",function(n){n.target===f&&ye()});function ye(){f.style.display="none",S.style.display="none",x.style.display="none",w.style.display="none",h.value="",q.value="",T.value="",A.innerHTML="",M.innerHTML="",g.textContent=""}const $=document.createElement("p");$.classList.add("modal__date");const h=document.createElement("input");h.setAttribute("type","date");h.classList.add("input__date");const V=document.createElement("div"),g=document.createElement("p");g.classList.add("error__msg");V.appendChild(g);const N=document.createElement("button");N.classList.add("button__search");N.textContent="Search available times";const U=document.createElement("p");U.classList.add("modal__name");const q=document.createElement("input");q.setAttribute("type","text");q.classList.add("input__name");const W=document.createElement("p");W.classList.add("modal__name");const T=document.createElement("input");T.setAttribute("type","text");T.classList.add("input__mail");const ne=document.createElement("p"),X=document.createElement("input");X.setAttribute("type","tel");const J=document.createElement("p");J.classList.add("modal__time");const fe=document.createElement("ul");fe.classList.add("time__list");const A=document.createElement("select");A.classList.add("select__menu__time");const G=document.createElement("p");G.classList.add("modal__participants");const M=document.createElement("select");M.classList.add("select__menu__part");const P=document.createElement("button");P.classList.add("button__submit");P.textContent="Submit booking";const Q=document.createElement("h1");Q.classList.add("title__thankyou");const O=document.createElement("a");O.classList.add("modal__linkback");const H=new Date,ae=H.toISOString().substring(0,10),ge=new Date(H.getFullYear(),H.getMonth()+12,H.getDate()),he=ge.toISOString().substring(0,10);function Le(){return f.style.display="block",S.style.display="block",E.setAttribute("id","modal1__title"),Z.textContent="What date would you like to come?",$.textContent="Date",h.value=ae,S.append(E,Z,$,h,V,N),f.append(S),E}function Ee(){E.textContent='Book Room: "'+b.data.title+'" (Step 2)',f.style.display="block",S.style.display="none",x.style.display="block",E.setAttribute("id","modal2__title"),U.textContent="Name",W.textContent="E-mail",ne.textContent="Phone number",J.textContent="What time?",G.textContent="How many participants?",x.append(E,V,U,q,W,T,ne,X,J,A,G,M,P),f.append(x)}async function _e(){f.style.display="block",x.style.display="none",w.style.display="flex",Q.textContent="Thank you!",O.text="Close window",O.setAttribute("href",""),w.append(Q,O),f.append(w)}async function be(){N.addEventListener("click",function(){let n=new URLSearchParams(v.search),l=b.data.id;return h.value<ae||h.value>he?(g.textContent="You must choose a date newer than today and within a year!",g.style.color="red"):(n.set("date",h.value),n.set("id",parseInt(l)),v.search=n.toString(),v=v.toString(),ve(),Ee(),g.textContent=""),v})}async function ve(){(await(await fetch(v)).json()).slots.forEach(n=>{K.push(n),D=document.createElement("option"),D.innerText=n,A.appendChild(D)});for(let n=b.data.minParticipants;n<=b.data.maxParticipants;n++)te.push(n);return te.forEach(n=>{Y=document.createElement("option"),Y.innerText=n+" participants",M.appendChild(Y)}),K}be();function Se(){P.addEventListener("click",function(){let n=b.data.id,l=q.value.trim(),a=l.charAt(0).toUpperCase()+l.slice(1).toLowerCase(),t=/^[a-zA-Z]+ [a-zA-Z]+$/,e=T.value.trim(),o=/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im,r=X.value,d=h.value;const s=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;if(a.match(t))if(e.match(s))if(r.match(o)){let p=A.selectedOptions,m="";for(let c=0;c<p.length;c++)m+=p[c].label;console.log(K);let i="",y=M.selectedOptions;for(let c=0;c<y.length;c++)i+=y[c].label;return xe(n,a,e,r,d,m,parseInt(i)),g.textContent="",_e(),!0}else return g.textContent="You must enter a 10-digit phone number",!1;else return g.textContent="You must enter a valid email!",!1;else return g.textContent="You must enter your first name and last name",!1})}Se();async function xe(n,l,a,t,e,o,r){const d=await(await fetch("https://lernia-sjj-assignments.vercel.app/api/booking/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challenge:n,name:l,email:a,phonenumber:t,date:e,time:o,participants:r})})).json();console.log(d)}
